# v6.3.2 Bug清单

## 已发现的问题

### 1. 聊天室白屏问题 ✓
**问题**: 聊天室UI白屏,无法使用
**原因**: admin_app.py中缺少unified-chat路由,前端无法调用API
**修复**: 在admin_app.py中添加 `admin_app.include_router(unified_chat_room_router)`
**状态**: 已修复

### 2. 控制面板模型显示问题 ✓
**问题**: 控制面板显示的"当前模型"来自环境变量,不是实际运行的模型
**原因**: `admin_app.py`的`get_status()`直接读取`LLM_MODEL`环境变量
**修复方案**: 
- 方案1: 使用`get_current_model()`从`/v1/models`获取第一个模型
- 方案2(推荐): 发送test请求,从响应的`model`字段获取实际模型
**修复**: 实现方案2,添加`get_actual_running_model()`函数
**状态**: 待修复

### 3. DeprecationWarning警告
**问题**: 使用了已弃用的`@app.on_event("startup")`
**位置**: `main.py:98` 和 `admin_app.py:69`
**修复**: 改用FastAPI的`lifespan`事件处理器
**优先级**: 低(不影响功能)
**状态**: 可选修复

## 检查结果总结

### 已检查项目
- [x] 聊天室功能 - **发现bug**
- [x] 控制面板模型检测 - **发现bug**
- [x] Dashboard APIs - ✅ 正常
- [x] Performance监控 - ✅ 正常
- [x] 容器启动日志 - ✅ 无错误
- [x] API端点 - ✅ 正常

### 未检查项目(需要实际测试)
- [ ] Playwright浏览器自动化
- [ ] 工具系统调用
- [ ] WebSocket实时通信

## 修复清单
1. ✅ 聊天室unified-chat路由 - **已完成**
2. ✅ 控制面板模型显示逻辑 - **已完成**
3. ❌ DeprecationWarning - **跳过**(不影响功能)

## v6.3.2 修复总结
- 添加unified-chat路由到admin_app.py
- 实现get_actual_running_model()函数
- 修改get_status()使用实际运行模型
- 所有修复已提交到Git

## 深度检查结果

### 现状(运行11分钟)
- ✅ Fleet API: healthy
- ✅ LLM连接: 正常(qwen.qwen3-vl-235b-a22b-instruct)
- ⏳ 工具系统: 等待15分钟预加载(还有4分钟)
- ❌ 聊天室: 白屏(需要部署v6.3.2)
- ❌ 模型显示: 显示环境变量(需要部署v6.3.2)

### 待验证项
- [ ] 15分钟后工具是否正常加载
- [ ] 部署v6.3.2后聊天室是否正常
- [ ] 部署v6.3.2后模型显示是否正确
