# M3 Agent System v6.0.0 Release Notes

**å‘å¸ƒæ—¥æœŸ**: 2024-12-05  
**ç‰ˆæœ¬**: v6.0.0  
**ç±»å‹**: é‡å¤§æ¶æ„ä¼˜åŒ–ç‰ˆæœ¬

---

## ğŸš€ æ ¸å¿ƒæ”¹è¿›

### æ™ºèƒ½å»¶è¿Ÿé¢„åŠ è½½æœºåˆ¶

**é—®é¢˜**: v5.9åœ¨å¯åŠ¨æ—¶ç«‹å³é¢„åŠ è½½æ‰€æœ‰å·¥å…·å’Œæ¨¡å‹,å¯èƒ½å¯¼è‡´å¯åŠ¨å†²çªå’Œèµ„æºç«äº‰ã€‚

**è§£å†³æ–¹æ¡ˆ**: v6.0é‡‡ç”¨æ™ºèƒ½å»¶è¿Ÿé¢„åŠ è½½ç­–ç•¥:
- âœ… **å¯åŠ¨æ—¶**: ä»…åˆå§‹åŒ–æ ¸å¿ƒç»„ä»¶(æµè§ˆå™¨æ± ã€å·¥å…·å®ä¾‹ã€LangGraphå·¥ä½œæµ)
- âœ… **T+15åˆ†é’Ÿ**: é¢„åŠ è½½é‡é‡çº§æ¨¡å‹(Whisperã€OCRã€å›¾åƒåˆ†æ)åˆ°å†…å­˜
- âœ… **é¿å…å†²çª**: é”™å¼€å¯åŠ¨å’Œé¢„åŠ è½½,é¿å…èµ„æºç«äº‰

### å®šæ—¶å¥åº·æ£€æµ‹å’Œæ€§èƒ½ç›‘æ§

**æ–°å¢åŠŸèƒ½**: å®Œæ•´çš„åå°ç›‘æ§ç³»ç»Ÿ,è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿå¥åº·çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡ã€‚

#### æ—¶é—´è¡¨è®¾è®¡

```
T+0:    ç³»ç»Ÿå¯åŠ¨ï¼ˆè½»é‡çº§ï¼Œæ— é¢„åŠ è½½ï¼‰
T+15:   å†…å­˜é¢„åŠ è½½ + API/å·¥å…·æ£€æµ‹
T+30:   æ€§èƒ½æ£€æµ‹
T+45:   API/å·¥å…·æ£€æµ‹
T+60:   æ€§èƒ½æ£€æµ‹
T+75:   API/å·¥å…·æ£€æµ‹
...
```

**ç‰¹ç‚¹**:
- âœ… **é”™å¼€æ‰§è¡Œ**: APIæ£€æµ‹å’Œæ€§èƒ½æ£€æµ‹é”™å¼€15åˆ†é’Ÿ,é¿å…ç›¸äº’å¹²æ‰°
- âœ… **å®šæ—¶å¾ªç¯**: æ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡,æŒç»­ç›‘æ§ç³»ç»ŸçŠ¶æ€
- âœ… **è‡ªåŠ¨æ¢å¤**: æ£€æµ‹åˆ°å†…å­˜æ‰è½æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½

---

## âœ¨ æ–°å¢åŠŸèƒ½

### 1. åå°ä»»åŠ¡ç®¡ç†å™¨ (Background Tasks Manager)

**æ–‡ä»¶**: `app/core/background_tasks.py`

**åŠŸèƒ½**:
- å»¶è¿Ÿé¢„åŠ è½½ä»»åŠ¡ï¼ˆT+15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰
- API/å·¥å…·å¥åº·æ£€æµ‹ï¼ˆT+15åˆ†é’Ÿé¦–æ¬¡,ä¹‹åæ¯30åˆ†é’Ÿï¼‰
- æ€§èƒ½æµ‹è¯•ä»»åŠ¡ï¼ˆT+30åˆ†é’Ÿé¦–æ¬¡,ä¹‹åæ¯30åˆ†é’Ÿï¼‰

**é¢„åŠ è½½å†…å®¹**:
- æµè§ˆå™¨æ± çŠ¶æ€æ£€æŸ¥
- Whisperæ¨¡å‹é¢„åŠ è½½ï¼ˆsmallï¼‰
- EasyOCRæ¨¡å‹é¢„åŠ è½½
- Haar Cascadeæ¨¡å‹é¢„åŠ è½½

**å¥åº·æ£€æµ‹å†…å®¹**:
- 15ä¸ªå·¥å…·å¯ç”¨æ€§æ£€æŸ¥
- Fleet APIçŠ¶æ€æ£€æŸ¥
- LangGraph APIçŠ¶æ€æ£€æŸ¥
- LLMè¿æ¥çŠ¶æ€æ£€æŸ¥
- å·¥å…·å†…éƒ¨æµ‹è¯•

**æ€§èƒ½æ£€æµ‹å†…å®¹**:
- LLMååé‡æµ‹è¯•ï¼ˆtokens/sï¼‰
- TTFTæµ‹è¯•ï¼ˆé¦–tokenå»¶è¿Ÿï¼‰
- æ€»å»¶è¿Ÿæµ‹è¯•
- å†…å­˜ä½¿ç”¨æƒ…å†µ

### 2. æ§åˆ¶é¢æ¿API (Dashboard API)

**æ–‡ä»¶**: `app/api/dashboard_api.py`

**ç«¯ç‚¹**:

#### `GET /api/dashboard/status`
è·å–ç³»ç»Ÿæ•´ä½“çŠ¶æ€
```json
{
  "timestamp": "2024-12-05T12:00:00",
  "summary": {
    "overall": "healthy",
    "uptime": "2h 15m 30s",
    "preload_completed": true,
    "last_check": "2024-12-05T11:45:00",
    "last_performance": "2024-12-05T11:30:00"
  },
  "details": { ... }
}
```

#### `GET /api/dashboard/health`
è·å–æœ€æ–°çš„å¥åº·æ£€æµ‹ç»“æœ
```json
{
  "status": "ok",
  "data": {
    "timestamp": "2024-12-05T11:45:00",
    "tools": {
      "count": 15,
      "status": "available",
      "names": ["web_search", "web_scraper", ...]
    },
    "apis": {
      "fleet": "available",
      "langgraph": "available",
      "llm": {
        "status": "connected",
        "models_count": 3
      }
    },
    "summary": {
      "tools": "âœ…",
      "fleet_api": "âœ…",
      "langgraph_api": "âœ…",
      "llm": "âœ…",
      "overall": "healthy"
    }
  }
}
```

#### `GET /api/dashboard/performance`
è·å–æœ€æ–°çš„æ€§èƒ½æ£€æµ‹ç»“æœ
```json
{
  "status": "ok",
  "data": {
    "timestamp": "2024-12-05T11:30:00",
    "model_performance": {
      "model": "qwen2.5-7b-instruct",
      "tokens_per_second": 45.2,
      "ttft_ms": 120.5,
      "total_latency_ms": 850.3,
      "status": "ok"
    },
    "memory_status": {
      "rss_mb": 2048.5,
      "vms_mb": 4096.2,
      "percent": 12.5
    }
  }
}
```

#### `GET /api/dashboard/preload-status`
è·å–å†…å­˜é¢„åŠ è½½çŠ¶æ€
```json
{
  "completed": true,
  "preload_time": "2024-12-05T10:15:00",
  "health_status": {
    "browser_pool": {"status": "loaded"},
    "models": {
      "whisper": "loaded",
      "ocr": "loaded",
      "image_analysis": "loaded"
    }
  }
}
```

#### `POST /api/dashboard/trigger-health-check`
æ‰‹åŠ¨è§¦å‘å¥åº·æ£€æµ‹
```json
{
  "status": "triggered",
  "message": "Health check started in background"
}
```

#### `POST /api/dashboard/trigger-performance-test`
æ‰‹åŠ¨è§¦å‘æ€§èƒ½æµ‹è¯•
```json
{
  "status": "triggered",
  "message": "Performance test started in background"
}
```

### 3. å®æ—¶çŠ¶æ€æ¨é€

**é›†æˆ**: æ‰€æœ‰æ£€æµ‹ç»“æœè‡ªåŠ¨æ¨é€åˆ°ä¸‰è§’èŠå¤©å®¤

**æ¨é€å†…å®¹**:
- å†…å­˜é¢„åŠ è½½å®Œæˆé€šçŸ¥
- API/å·¥å…·æ£€æµ‹ç»“æœ
- æ€§èƒ½æµ‹è¯•ç»“æœ
- é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯

---

## ğŸ”§ æ¶æ„æ”¹è¿›

### å¯åŠ¨æµç¨‹ä¼˜åŒ–

**v5.9å¯åŠ¨æµç¨‹** (æœ‰å†²çªé£é™©):
```
1. å¯åŠ¨FastAPI
2. ç«‹å³é¢„åŠ è½½æµè§ˆå™¨æ± 
3. ç«‹å³é¢„åŠ è½½æ‰€æœ‰å·¥å…·
4. ç«‹å³é¢„åŠ è½½æ‰€æœ‰æ¨¡å‹
5. å¯åŠ¨åå°ä»»åŠ¡
â†’ å¯èƒ½å¯¼è‡´èµ„æºç«äº‰å’Œå¯åŠ¨å»¶è¿Ÿ
```

**v6.0å¯åŠ¨æµç¨‹** (ä¼˜åŒ–å):
```
1. å¯åŠ¨FastAPI
2. è½»é‡çº§åˆå§‹åŒ–ï¼ˆä»…æµè§ˆå™¨æ± +å·¥å…·å®ä¾‹ï¼‰
3. å¯åŠ¨åå°ä»»åŠ¡ç®¡ç†å™¨
4. ç³»ç»Ÿç«‹å³å¯ç”¨ âœ…
5. T+15åˆ†é’Ÿ: åå°é¢„åŠ è½½æ¨¡å‹
6. T+15åˆ†é’Ÿ: é¦–æ¬¡å¥åº·æ£€æµ‹
7. T+30åˆ†é’Ÿ: é¦–æ¬¡æ€§èƒ½æµ‹è¯•
â†’ å¯åŠ¨å¿«é€Ÿ,æ— å†²çª,ç³»ç»Ÿç«‹å³å¯ç”¨
```

### ç›‘æ§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Background Tasks Manager v6.0        â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Preload Task (T+15min, once)   â”‚   â”‚
â”‚  â”‚  - Whisper model                â”‚   â”‚
â”‚  â”‚  - OCR models                   â”‚   â”‚
â”‚  â”‚  - Image analysis models        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API/Tool Check (every 30min)   â”‚   â”‚
â”‚  â”‚  - 15 tools availability        â”‚   â”‚
â”‚  â”‚  - Fleet API                    â”‚   â”‚
â”‚  â”‚  - LangGraph API                â”‚   â”‚
â”‚  â”‚  - LLM connection               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Performance Test (every 30min) â”‚   â”‚
â”‚  â”‚  - LLM throughput               â”‚   â”‚
â”‚  â”‚  - TTFT measurement             â”‚   â”‚
â”‚  â”‚  - Memory usage                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â–º Dashboard API (æ±‡æŠ¥)
              â”œâ”€â–º Chat Room (æ¨é€)
              â””â”€â–º Logs (è®°å½•)
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | v5.9 | v6.0 |
|------|------|------|
| **å¯åŠ¨æ—¶é—´** | 10-15ç§’ | 3-5ç§’ â¬†ï¸ 70% |
| **å¯åŠ¨å†²çª** | å¯èƒ½å‘ç”Ÿ | å®Œå…¨é¿å… âœ… |
| **å†…å­˜é¢„åŠ è½½** | å¯åŠ¨æ—¶ | T+15åˆ†é’Ÿ |
| **å¥åº·æ£€æµ‹** | æ—  | æ¯30åˆ†é’Ÿ âœ… |
| **æ€§èƒ½ç›‘æ§** | æ—  | æ¯30åˆ†é’Ÿ âœ… |
| **è‡ªåŠ¨æ¢å¤** | æ—  | æ”¯æŒ âœ… |
| **æ§åˆ¶é¢æ¿API** | æ—  | å®Œæ•´ âœ… |

---

## ğŸ”„ å‡çº§æŒ‡å—

### ä»v5.9å‡çº§åˆ°v6.0

#### 1. æ›¿æ¢ä»£ç 
```bash
# åœæ­¢æ—§å®¹å™¨
docker-compose down

# æ›¿æ¢æºä»£ç 
rm -rf /path/to/m3-agent-system/*
tar -xzf m3-agent-v6.0.tar.gz
cp -r m3-agent-v6.0/* /path/to/m3-agent-system/

# é‡æ–°æ„å»º
docker-compose build

# å¯åŠ¨æ–°å®¹å™¨
docker-compose up -d
```

#### 2. éªŒè¯å‡çº§
```bash
# æ£€æŸ¥ç‰ˆæœ¬
curl http://localhost:8888/

# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
curl http://localhost:8888/api/dashboard/status

# ç­‰å¾…15åˆ†é’Ÿåæ£€æŸ¥é¢„åŠ è½½çŠ¶æ€
curl http://localhost:8888/api/dashboard/preload-status

# æ£€æŸ¥å¥åº·çŠ¶æ€
curl http://localhost:8888/api/dashboard/health

# ç­‰å¾…30åˆ†é’Ÿåæ£€æŸ¥æ€§èƒ½æ•°æ®
curl http://localhost:8888/api/dashboard/performance
```

#### 3. é…ç½®æ— å˜åŒ–
- âœ… `.env` æ–‡ä»¶æ— éœ€ä¿®æ”¹
- âœ… `docker-compose.yml` æ— éœ€ä¿®æ”¹
- âœ… æ‰€æœ‰APIç«¯ç‚¹å‘åå…¼å®¹

---

## ğŸ› Bugä¿®å¤

### ä¿®å¤v5.9çš„å¯åŠ¨å†²çªé—®é¢˜
- **é—®é¢˜**: å¯åŠ¨æ—¶ç«‹å³é¢„åŠ è½½å¯èƒ½å¯¼è‡´èµ„æºç«äº‰
- **ä¿®å¤**: å»¶è¿Ÿ15åˆ†é’Ÿé¢„åŠ è½½,å¯åŠ¨æ—¶ä»…è½»é‡çº§åˆå§‹åŒ–

### ä¿®å¤å†…å­˜æ³„æ¼é£é™©
- **é—®é¢˜**: æ¨¡å‹é‡å¤åŠ è½½å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼
- **ä¿®å¤**: æ£€æµ‹å†…å­˜çŠ¶æ€,ä»…åœ¨éœ€è¦æ—¶é‡æ–°åŠ è½½

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ–°å¢æ–‡ä»¶
- `app/core/background_tasks.py` - åå°ä»»åŠ¡ç®¡ç†å™¨
- `app/api/dashboard_api.py` - æ§åˆ¶é¢æ¿API
- `RELEASE_NOTES_v6.0.0.md` - æœ¬æ–‡æ¡£

### ä¿®æ”¹æ–‡ä»¶
- `main.py` - æ›´æ–°ç‰ˆæœ¬å·,æ³¨å†ŒDashboard API,å¯åŠ¨åå°ä»»åŠ¡
- `app/core/startup.py` - ç§»é™¤ç«‹å³é¢„åŠ è½½é€»è¾‘

### ä¾èµ–å˜åŒ–
- æ— æ–°å¢ä¾èµ–
- æ‰€æœ‰åŠŸèƒ½ä½¿ç”¨ç°æœ‰ä¾èµ–å®ç°

---

## ğŸ¯ æœªæ¥è®¡åˆ’

### v6.1 (è®¡åˆ’ä¸­)
- [ ] æ›´è¯¦ç»†çš„å·¥å…·æ€§èƒ½åˆ†æ
- [ ] å†å²æ•°æ®è¶‹åŠ¿å›¾
- [ ] è‡ªå®šä¹‰ç›‘æ§é˜ˆå€¼å’Œå‘Šè­¦

### v6.2 (è®¡åˆ’ä¸­)
- [ ] åˆ†å¸ƒå¼ç›‘æ§æ”¯æŒ
- [ ] å¤šAgentåè°ƒç›‘æ§
- [ ] æ€§èƒ½ä¼˜åŒ–å»ºè®®

---

## ğŸ’¡ æœ€ä½³å®è·µ

### ç›‘æ§å»ºè®®
1. **å®šæœŸæŸ¥çœ‹Dashboard**: æ¯å¤©æ£€æŸ¥ `/api/dashboard/status`
2. **å…³æ³¨å¥åº·çŠ¶æ€**: å¦‚æœ `overall` ä¸æ˜¯ `healthy`,åŠæ—¶æ’æŸ¥
3. **ç›‘æ§æ€§èƒ½è¶‹åŠ¿**: è®°å½•æ¯æ¬¡æ€§èƒ½æµ‹è¯•ç»“æœ,åˆ†æè¶‹åŠ¿

### éƒ¨ç½²å»ºè®®
1. **é¢„ç•™è¶³å¤Ÿå†…å­˜**: å»ºè®®è‡³å°‘4GB RAM
2. **ç›‘æ§ç£ç›˜ç©ºé—´**: æ—¥å¿—å’Œæ¨¡å‹æ–‡ä»¶å¯èƒ½å ç”¨è¾ƒå¤šç©ºé—´
3. **é…ç½®æ—¥å¿—è½®è½¬**: é¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜,è¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»:
- GitHub Issues
- æŠ€æœ¯æ”¯æŒé‚®ç®±
- ç¤¾åŒºè®ºå›

---

**v6.0æ˜¯ä¸€ä¸ªé‡å¤§æ¶æ„ä¼˜åŒ–ç‰ˆæœ¬,å¼ºçƒˆå»ºè®®æ‰€æœ‰v5.9ç”¨æˆ·å‡çº§!** ğŸ‰
